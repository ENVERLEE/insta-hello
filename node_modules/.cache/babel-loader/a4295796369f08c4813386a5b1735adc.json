{"ast":null,"code":"var _jsxFileName = \"/Users/ROSA/Desktop/insta/project-root/insta-hello/src/components/ResultPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport html2canvas from 'html2canvas';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ResultPage = () => {\n  _s();\n  const location = useLocation();\n  const {\n    name,\n    answers\n  } = location.state;\n  const [letter, setLetter] = useState('');\n  const [keywords, setKeywords] = useState([]);\n  const [descriptor, setDescriptor] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const resultRef = useRef(null);\n  useEffect(() => {\n    const fetchLetter = async () => {\n      setLoading(true);\n      setError(null); // Reset error state before fetching\n\n      try {\n        const response = await axios.post(`${process.env.REACT_APP_API_URL}/api/love-letter`, {\n          name,\n          answers\n        });\n\n        // Log the entire response for debugging\n        console.log('API Response:', response);\n\n        // Extract data from response\n        const {\n          letter: fullLetter,\n          keywords,\n          descriptor\n        } = response.data;\n\n        // Parse the full letter to extract keywords and descriptor\n        const letterContent = fullLetter.split('3. Descriptor:')[0].trim(); // Extract content before \"3. Descriptor:\"\n        const descriptorContent = descriptor || '단어 요약이 없습니다.';\n\n        // If keywords are not provided, default to an empty array\n        const keywordsContent = keywords || [];\n        setLetter(letterContent || '러브레터를 불러오는 데 실패했습니다.');\n        setKeywords(keywordsContent);\n        setDescriptor(descriptorContent);\n      } catch (error) {\n        console.error('러브레터 생성에 실패했습니다:', error);\n        setLetter('러브레터를 불러오는 데 실패했습니다.');\n        setKeywords([]);\n        setDescriptor('단어 요약이 없습니다.');\n        setError('정보를 불러오는 데 실패했습니다. 나중에 다시 시도해 주세요.');\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchLetter();\n  }, [name, answers]);\n  const handleShare = async () => {\n    if (resultRef.current) {\n      try {\n        const canvas = await html2canvas(resultRef.current);\n        const image = canvas.toDataURL('image/png');\n        const link = document.createElement('a');\n        link.href = image;\n        link.download = 'love-letter.png';\n        link.click();\n        const isMobile = /android|iPhone|iPad|iPod/i.test(navigator.userAgent);\n        if (isMobile) {\n          const instagramUrl = 'instagram://story-camera';\n          window.location.href = instagramUrl;\n        } else {\n          alert('Instagram 스토리 공유는 모바일에서만 가능합니다.');\n        }\n      } catch (error) {\n        console.error('Instagram 스토리 공유에 실패했습니다:', error);\n        alert('Instagram 스토리 공유에 실패했습니다. 나중에 다시 시도해 주세요.');\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: descriptor && descriptor !== '단어 요약이 없습니다.' ? `${descriptor} 당신의 러브레터` : '러브레터'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\uB85C\\uB529 \\uC911...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this) : error ? /*#__PURE__*/_jsxDEV(\"p\", {\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: resultRef,\n      children: [letter ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: letter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\uB7EC\\uBE0C\\uB808\\uD130\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uB370 \\uC2E4\\uD328\\uD588\\uC2B5\\uB2C8\\uB2E4.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this), keywords.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\uD0A4\\uC6CC\\uB4DC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: keywords.map((keyword, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n            children: keyword\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\uD0A4\\uC6CC\\uB4DC\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 13\n      }, this), descriptor ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\uD55C \\uB2E8\\uC5B4 \\uC694\\uC57D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: descriptor\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\uB2E8\\uC5B4 \\uC694\\uC57D\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleShare,\n      disabled: loading,\n      children: \"\\uC778\\uC2A4\\uD0C0\\uADF8\\uB7A8 \\uC2A4\\uD1A0\\uB9AC\\uC5D0 \\uACF5\\uC720\\uD558\\uAE30\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n};\n_s(ResultPage, \"dJ17o3vEA03pcSqf8ntMERRvsTk=\", false, function () {\n  return [useLocation];\n});\n_c = ResultPage;\nexport default ResultPage;\nvar _c;\n$RefreshReg$(_c, \"ResultPage\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useLocation","axios","html2canvas","jsxDEV","_jsxDEV","ResultPage","_s","location","name","answers","state","letter","setLetter","keywords","setKeywords","descriptor","setDescriptor","loading","setLoading","error","setError","resultRef","fetchLetter","response","post","process","env","REACT_APP_API_URL","console","log","fullLetter","data","letterContent","split","trim","descriptorContent","keywordsContent","handleShare","current","canvas","image","toDataURL","link","document","createElement","href","download","click","isMobile","test","navigator","userAgent","instagramUrl","window","alert","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","length","map","keyword","index","onClick","disabled","_c","$RefreshReg$"],"sources":["/Users/ROSA/Desktop/insta/project-root/insta-hello/src/components/ResultPage.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport html2canvas from 'html2canvas';\n\nconst ResultPage = () => {\n  const location = useLocation();\n  const { name, answers } = location.state;\n  const [letter, setLetter] = useState('');\n  const [keywords, setKeywords] = useState([]);\n  const [descriptor, setDescriptor] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const resultRef = useRef(null);\n\n  useEffect(() => {\n    const fetchLetter = async () => {\n      setLoading(true);\n      setError(null); // Reset error state before fetching\n\n      try {\n        const response = await axios.post(`${process.env.REACT_APP_API_URL}/api/love-letter`, { name, answers });\n\n        // Log the entire response for debugging\n        console.log('API Response:', response);\n\n        // Extract data from response\n        const { letter: fullLetter, keywords, descriptor } = response.data;\n\n        // Parse the full letter to extract keywords and descriptor\n        const letterContent = fullLetter.split('3. Descriptor:')[0].trim(); // Extract content before \"3. Descriptor:\"\n        const descriptorContent = descriptor || '단어 요약이 없습니다.';\n        \n        // If keywords are not provided, default to an empty array\n        const keywordsContent = keywords || [];\n\n        setLetter(letterContent || '러브레터를 불러오는 데 실패했습니다.');\n        setKeywords(keywordsContent);\n        setDescriptor(descriptorContent);\n      } catch (error) {\n        console.error('러브레터 생성에 실패했습니다:', error);\n        setLetter('러브레터를 불러오는 데 실패했습니다.');\n        setKeywords([]);\n        setDescriptor('단어 요약이 없습니다.');\n        setError('정보를 불러오는 데 실패했습니다. 나중에 다시 시도해 주세요.');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchLetter();\n  }, [name, answers]);\n\n  const handleShare = async () => {\n    if (resultRef.current) {\n      try {\n        const canvas = await html2canvas(resultRef.current);\n        const image = canvas.toDataURL('image/png');\n        const link = document.createElement('a');\n        link.href = image;\n        link.download = 'love-letter.png';\n        link.click();\n\n        const isMobile = /android|iPhone|iPad|iPod/i.test(navigator.userAgent);\n        if (isMobile) {\n          const instagramUrl = 'instagram://story-camera';\n          window.location.href = instagramUrl;\n        } else {\n          alert('Instagram 스토리 공유는 모바일에서만 가능합니다.');\n        }\n      } catch (error) {\n        console.error('Instagram 스토리 공유에 실패했습니다:', error);\n        alert('Instagram 스토리 공유에 실패했습니다. 나중에 다시 시도해 주세요.');\n      }\n    }\n  };\n\n  return (\n    <div>\n      <h1>{descriptor && descriptor !== '단어 요약이 없습니다.' ? `${descriptor} 당신의 러브레터` : '러브레터'}</h1>\n      {loading ? (\n        <p>로딩 중...</p>\n      ) : error ? (\n        <p>{error}</p>\n      ) : (\n        <div ref={resultRef}>\n          {letter ? (\n            <div>\n              <p>{letter}</p>\n            </div>\n          ) : (\n            <p>러브레터를 불러오는 데 실패했습니다.</p>\n          )}\n\n          {keywords.length > 0 ? (\n            <div>\n              <h2>키워드</h2>\n              <ul>\n                {keywords.map((keyword, index) => (\n                  <li key={index}>{keyword}</li>\n                ))}\n              </ul>\n            </div>\n          ) : (\n            <p>키워드가 없습니다.</p>\n          )}\n\n          {descriptor ? (\n            <div>\n              <h2>한 단어 요약</h2>\n              <p>{descriptor}</p>\n            </div>\n          ) : (\n            <p>단어 요약이 없습니다.</p>\n          )}\n        </div>\n      )}\n      <button onClick={handleShare} disabled={loading}>인스타그램 스토리에 공유하기</button>\n    </div>\n  );\n};\n\nexport default ResultPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}